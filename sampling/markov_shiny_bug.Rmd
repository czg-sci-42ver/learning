---
title: "test"
# output:
#  html_document:
#  toc: true
#  toc_depth: 2
# fontsize: 11pt
# geometry: margin=1in

# output:
#  slidy_presentation:
#  incremental: true
# runtime: shiny

# title: "My R Markdown Notebook"
author: 
    - Rahul Bhadani^[The University of Arizona, rahulbhadani@email.arizona.edu]
date: "`r format(Sys.time(), '%d %B %Y')`"
# bibliography: biblio.bib
output:
#   pdf_document:
#     citation_package: natbib
#     # keep_tex: yes
#     number_sections: yes
  html_notebook: default
  html_document:
    df_print: paged
classoption:
- onecolumn
header-includes:
# - \usepackage[none]{hyphenat}
# - \usepackage{physics}
# - \graphicspath{ {figures/} }
# - \usepackage{color}
# - \definecolor{ocre}{RGB}{243,102,25}
# - \usepackage[font={color=ocre,bf},labelfont=bf]{caption}
# - \usepackage{hyperref}
# - \hypersetup{colorlinks=true,citecolor=blue}
# - \def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
#     T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
# - \newcommand{\spliteq}[1]{\begin{equation}\begin{split}#1\end{split}\end{equation}}
# keep_tex: yes
abstract: This is my abstract
---
# recommend [issue](https://github.com/REditorSupport/vscode-R/issues/103)

# template 1

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and Microsoft Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you select the **R Tools | Publish | Preview** button, a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

# [template 2](https://towardsdatascience.com/powerful-r-markdown-for-python-users-f20607f24f08)
> no use `setup` in `{r setup, include=FALSE}`
```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, echo=T,eval=T,warning=FALSE, fig.height = 4, fig.width = 5}
# install.packages("nloptr")
library("nloptr")
hn <- function(x, n) {
    hret <- 0
    if (n == 0) {
        hret <- x + 2 * x
    } else {
        hret <- x - 2 * x
    }
    return(hret)
}
```

```{bash, engine.opts='-l'}
source ~/.bashrc
# source /opt/ros/melodic/setup.bash
# source ~/catkin_ws/devel/setup.bash
pwd
ls
export http_proxy=127.0.0.1:1081
export https_proxy=127.0.0.1:1081
```

{python, engine.path =  "/home/username/anaconda3/envs/virtualenv/bin/python", fig.height = 3, fig.width = 6}
# ```{python, engine.path =  "~/venv/bin/python", fig.height = 3, fig.width = 6}
# # import pandas as pd
# # import seaborn as sns
# # iris = sns.load_dataset('iris')
# # iris.head()
# # iris['sepal_length'].plot()
# ```

## complicated
```{r}
# Load the required packages.
# If these are not available, install them first.
# temp  <- installed.packages()
# ipak <- function(pkg) {
#     new.l  <- 1
#     new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
#     if (length(new.pkg)) {
#           install.packages(new.pkg,
#               dependencies = TRUE
#           )
#       }
#     sapply(pkg,
#         require,
#         character.only = TRUE
#     )
# }
# packages <- c(
#     "tidyverse", # Data wrangling
#     "gapminder", # Data source
#     "knitr", # R Markdown styling
#     "htmltools"
# ) # .html files manipulation
# ipak(packages)
```

```{r}
# The "weapon of choice"
library(reticulate)
# Specifying which version of python to use.
# use_python("~/venv/bin/python", 
#            required = T) # Locate and run Python
use_virtualenv("venv")
```

```{python}
import pandas as pd # data wrangling
import numpy as np # arrays, matrices, math
import statistics as st # functions for calculating statistics
import plotly.express as px # plotting package
```

```{r}
# Let us begin with the most recent set of data
library(gapminder)
library(dplyr)
gapminder_latest <- gapminder %>% filter(year == max(year))
```

# my trial

[tutorial](https://www.stat.berkeley.edu/~mgoldman/Section0220.pdf)
[also](https://cran.r-project.org/doc/manuals/r-release/R-intro.html#Using-R-interactively)
# method 1
```{r}

```
```{r}
a <- solve(matrix(c(-.4, .1, .2, .1, -.3, .2, 1, 1, 1), nrow = 3, byrow = T), c(0, 0, 1))
# b <- solve(matrix(c(.6, .1, .2, .1, .7, .2, 1, 1, 1), nrow = 3, byrow = T), c(0, 0, 1))
# P <- matrix(c(.6, .1, .2, .1, .7, .2, 1, 1, 1), nrow = 3, byrow = T)
# P
```
----
# method 2
```{r}
x <- matrix(c(.6, .1, .3, .1, .7, .2, .2, .2, .6), nrow = 3, byrow = T)
y <- x
for (i in 1:25) {
      y <- y %*% x
  }
```

# function
```{r}
twosam <- function(y1, y2) {
    n1 <- length(y1)
    n2 <- length(y2)
    yb1 <- mean(y1)
    yb2 <- mean(y2)
    s1 <- var(y1)
    s2 <- var(y2)
    s <- ((n1 - 1) * s1 + (n2 - 1) * s2) / (n1 + n2 - 2)
    tst <- (yb1 - yb2) / sqrt(s * (1 / n1 + 1 / n2))
    tst
}

group1 <- rnorm(100)
group2 <- rnorm(100, mean = .1)

test <- twosam(group1, group2)
test2 <- t.test(group1, group2)

# cmd <- 'bash -c ". ~/R_code/bind.bash"'
# cat(cmd)
# system(cmd)


```

# [with python](https://bookdown.org/yihui/rmarkdown-cookbook/eng-python.html)
```{python}
print("Hello Python!")
```

```{r, setup}
library(reticulate)
```

Create a variable `x` in the Python session:

```{python}
x = [1, 2, 3]
```

Access the Python variable `x` in an R code chunk:

```{r}
py$x
```

Create a new variable `y` in the Python session using R,
and pass a data frame to `y`:

```{r}
py$y <- head(cars)
```

Print the variable `y` in Python:

```{python}
print(y)
```

## [also rstudio tutorial](https://rstudio.github.io/reticulate/#python-in-r-markdown)

```{r}
library(reticulate)
os <- import("os")
os$listdir(".")
```

```{r}
library(reticulate)
# use_virtualenv("myenv")
```

### try `repl_python()`